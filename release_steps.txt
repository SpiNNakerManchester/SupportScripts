# Copyright (c) 2023 The University of Manchester
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

This is the steps used for release 7.0.0 using ubuntu
Assumes twine is installed and pypi accounts setup
Warning The pypi steps 7 and 10 can not be repeated so make sure test passed!

1. Update master/main locally on all repositories
2. Run automatic_make.sh (from parent)
3. Get Add pip freeze info from github actions prepare stage
4. cap key dependecies in setup cfg
   - SpiNNUtils/setup.cfg numpy
   - sPyNNaker/setup.cfg p
5. Update release.pl
    - my $release = (release version)
    - my $old_release = (version in master)
    - my $release_name =
    - my $is_release = 1
6. Update but NOT merge https://github.com/SpiNNakerManchester/IntegrationTests/pull/325
7. perl release.pl (from inside SupportScripts)
   - This creates new branches with this release
   - This updates version number as required.
   - This does a new -python3 build
   - This pushes the branches to github
   # - This checks the readthedocs
   - This script can be repeated in which case it delete previous branches
8. Check all github actions passed
    Note Intergation tests branch prepared but not pushed

9. sh SupportScripts/testpypi.sh (from parent)
10. push Intergation test branch
11. Check test

12. Add pip free info from from tests

13. Check version is correct in dist gz files
14. sh SupportScripts/pypi.sh (from parent)
15. edit self_hosted_tests.yml
    -  Python install from testpypi ->  Python install from pypi
    remove (*3) "-i https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple/"
    if not a pre remove the -pre as well
16. Check Intergation Test

17. Update release.pl
    - my $release = (version for master)
    - my $old_release = (release version)
    - my $release_name =
    - my $is_release = 0
18. perl release.pl (from inside SupportScripts)

19. Change version in tag.pl  (release version)
20. perl tag.pl (from inside SupportScripts)

21. remove pip free info
22. Any other changes like python versions ect
23. Create pull requests
24. merge PRs`

For Java in github do a new release and include JavaSpiNNaker/SpiNNaker-front-end/target/spinnaker-exe.jar
